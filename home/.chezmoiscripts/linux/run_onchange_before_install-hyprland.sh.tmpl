{{ if and (not .ephemeral) (not .headless) -}}

{{      if eq .osid "linux-arch" -}}
#!/usr/bin/env bash

# Hyprland and Wayland core packages
yay -S --noconfirm --needed \
  hyprland \
  xdg-desktop-portal-hyprland \
  xdg-desktop-portal-gtk \
  qt5-wayland \
  qt6-wayland \
  polkit-gnome \
  xwaylandvideobridge

# Notification library (Quickshell handles notification display)
yay -S --noconfirm --needed libnotify

# Screen locking and idle management
yay -S --noconfirm --needed \
  hyprlock \
  hypridle

# Screenshots
yay -S --noconfirm --needed \
  grim \
  slurp \
  swappy

# Wallpaper management
yay -S --noconfirm --needed \
  swaybg \
  hyprpaper

# Clipboard manager
yay -S --noconfirm --needed \
  wl-clipboard \
  cliphist

# Additional utilities
yay -S --noconfirm --needed \
  dex \
  brightnessctl \
  hyprpicker \
  wlogout

# Hyprland plugin: EasyMotion
# Note: hyprpm needs a compatible Hyprland runtime; if unavailable during
# installation, the user can run these commands manually later.
if command -v hyprpm >/dev/null 2>&1; then
  hyprpm add https://github.com/zakk4223/hyprland-easymotion || true
  hyprpm enable hyprEasymotion || true
else
  echo "hyprpm not found. Run later:"
  echo "  hyprpm add https://github.com/zakk4223/hyprland-easymotion"
  echo "  hyprpm enable hyprEasymotion"
fi

# NOTE: playerctl and pamixer are installed by run_onchange_before_install-packages.sh.tmpl
#       to avoid duplication here. Both are Wayland/X11 agnostic utilities.

{{      end -}}

{{ end -}}
