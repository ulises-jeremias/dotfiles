# ╔══════════════════════════════════════════════════════════════════════════════╗
# ║                     HorneroConfig — Ranger Configuration                    ║
# ║                                                                              ║
# ║  A curated, theme-adaptive terminal file manager configuration.              ║
# ║  Managed by chezmoi — edit the template, not the generated file.             ║
# ║                                                                              ║
# ║  Quick Reference:                                                            ║
# ║    :cheatsheet  — Show all custom keybindings                                ║
# ║    ?            — Built-in help                                              ║
# ║    Ctrl-f       — Fuzzy file search (fzf)                                   ║
# ║    Ctrl-g       — Search inside file contents (ripgrep)                      ║
# ║    DD           — Safe delete (trash)                                        ║
# ║                                                                              ║
# ║  Image previews use kitty protocol (native Wayland support).                 ║
# ║  Colors auto-adapt to your current rice via smart-colors.                    ║
# ╚══════════════════════════════════════════════════════════════════════════════╝

# Note: RANGER_LOAD_DEFAULT_RC is set as an environment variable by dots-ranger,
# not as a ranger setting. This config is a complete standalone replacement.

# ═══════════════════════════════════════════════════════════════════════════════
# ══ APPEARANCE
# ═══════════════════════════════════════════════════════════════════════════════

# Miller columns view — the classic 3-pane layout
# Left: parent dir | Center: current dir | Right: preview pane
set viewmode miller

# Column proportions (parent:current:preview) — generous preview space
set column_ratios 2,4,4

# Draw beautiful borders around all panes
set draw_borders both

# Use unicode ellipsis (…) for truncated filenames
set unicode_ellipsis true

# Show devicons (Nerd Font icons) next to files
# Requires: ranger_devicons plugin + Nerd Font (Hack Nerd Font is configured in kitty)
default_linemode devicons

# Colorscheme — uses smart-colors integration that adapts to your current rice
# The "smart" colorscheme reads colors from ~/.cache/dots/smart-colors/
set colorscheme smart

# Show dotfiles by default (toggle with zh)
set show_hidden true

# Filter out common noise files
set hidden_filter ^\.|\.(?:pyc|pyo|bak|swp)$|^lost\+found$|^__(py)?cache__$

# Show file sizes in the main column
set display_size_in_main_column true
set display_size_in_status_bar true

# Show free disk space in the status bar
set display_free_space_in_status_bar true

# Display file tags in all columns
set display_tags_in_all_columns true

# Line numbers (relative for vim-like jumping)
set line_numbers relative
set relative_current_zero true
set one_indexed false

# Shorten the title bar
set shorten_title 3
set hostname_in_titlebar true
set tilde_in_titlebar true

# Updates the terminal/tmux title
set update_title true
set update_tmux_title true

# Status bar at the bottom
set status_bar_on_top false
set draw_progress_bar_in_status_bar true

# Directory name in tabs for easy identification
set dirname_in_tabs true

# ═══════════════════════════════════════════════════════════════════════════════
# ══ PREVIEWS — The "WOW" Factor
# ═══════════════════════════════════════════════════════════════════════════════
#
# Ranger can preview almost anything inline:
#   - Images (JPG, PNG, WebP, SVG, GIF) — rendered in the terminal via kitty protocol
#   - Code — syntax highlighted via bat with your current theme
#   - PDFs — first page rendered as image
#   - Videos — thumbnail frame extracted
#   - Archives — file listing shown
#   - Markdown — rendered beautifully
#   - JSON/YAML — pretty-printed and colored
#   - Fonts — preview with sample text
#   - And more...
#
# Dependencies are installed by the install-ranger.sh chezmoi script.
# Missing dependencies degrade gracefully — you just get plain text instead.

# Enable the preview script (scope.sh handles all preview logic)
set preview_files true
set preview_directories true
set collapse_preview true
set use_preview_script true
set preview_script ~/.config/ranger/scope.sh

# Image previews — THE FIX for Wayland/Hyprland
# The kitty protocol works natively on Wayland through kitty terminal.
# No ueberzug needed! (ueberzug is X11-only and broken on Wayland)
set preview_images true
{{ if eq (env "TERM") "xterm-kitty" -}}
set preview_images_method kitty
{{ else -}}
# Fallback: auto-detect terminal
# kitty: native protocol, best quality (default for this setup)
# ueberzug: X11-only fallback
set preview_images_method kitty
{{ end -}}

# Don't preview files larger than 5MB (prevents freezing on huge binaries)
set preview_max_size 5000000

# Wrap long lines in text previews
set wrap_plaintext_previews false

# Open all images in the directory when launching an image viewer
set open_all_images true

# ═══════════════════════════════════════════════════════════════════════════════
# ══ GIT INTEGRATION — Visual VCS Status
# ═══════════════════════════════════════════════════════════════════════════════
#
# Files and directories show git status indicators:
#   ✓  Tracked / clean
#   +  Staged for commit
#   ✗  Modified / dirty
#   ?  Untracked
#   This is a killer feature that Thunar doesn't have!

set vcs_aware true
set vcs_backend_git enabled
set vcs_backend_hg disabled
set vcs_backend_bzr disabled
set vcs_backend_svn disabled
set vcs_msg_length 50

# ═══════════════════════════════════════════════════════════════════════════════
# ══ NAVIGATION & BEHAVIOR
# ═══════════════════════════════════════════════════════════════════════════════

# Confirm deletion only when multiple files are selected
set confirm_on_delete multiple

# Automatically count files in directories
set automatically_count_files true

# Scroll offset — keep cursor centered with this many lines of padding
set scroll_offset 8

# Enable mouse support (click to navigate, scroll to browse)
set mouse_enabled true

# Fuzzy tab completion for :cd command
# Example: :cd /u/lo/b<tab> → :cd /usr/local/bin
set cd_tab_fuzzy true
set cd_tab_case insensitive
set cd_bookmarks true

# History and bookmarks
set max_history_size 20
set max_console_history_size 50
set save_console_history true
set autosave_bookmarks true
set save_backtick_bookmark true
set show_hidden_bookmarks true

# Performance
set flushinput true
set idle_delay 2000
set autoupdate_cumulative_size false
set freeze_files false

# Warn about nested ranger instances
set nested_ranger_warning true

# Don't sort with unicode by default
set sort natural
set sort_reverse false
set sort_case_insensitive true
set sort_directories_first true
set sort_unicode false

# Padding
set padding_right true

# Metadata
set metadata_deep_search false
set clear_filters_on_dir_change false

# Save tabs on exit (restore your workspace)
set save_tabs_on_exit true

# File size display
set size_in_bytes false

# Cursor visibility
set show_cursor false

# Selection in titlebar
set show_selection_in_titlebar true

# Key hint threshold
set hint_collapse_threshold 10

# Image preview settings for other protocols (not used with kitty but kept for reference)
set w3m_delay 0.02
set w3m_offset 0
set iterm2_font_width 8
set iterm2_font_height 11

# BIDI support for RTL languages
set bidi_support false

# ═══════════════════════════════════════════════════════════════════════════════
# ══ COMMAND ALIASES
# ═══════════════════════════════════════════════════════════════════════════════

alias e     edit
alias q     quit
alias q!    quit!
alias qa    quitall
alias qa!   quitall!
alias qall  quitall
alias qall! quitall!
alias setl  setlocal

alias filter     scout -prts
alias find       scout -aets
alias mark       scout -mr
alias unmark     scout -Mr
alias search     scout -rs
alias search_inc scout -rts
alias travel     scout -aefklst

# ═══════════════════════════════════════════════════════════════════════════════
# ══ KEYBINDINGS — Browser
# ═══════════════════════════════════════════════════════════════════════════════
#
# Legend:
#   map KEY COMMAND          — map a key in browser mode
#   cmap KEY COMMAND         — map a key in console mode
#   pmap KEY COMMAND         — map a key in pager mode
#   tmap KEY COMMAND         — map a key in taskview mode
#   copymap OLD NEW          — copy a mapping
#
# Modifiers:
#   <C-x>    — Ctrl+x
#   <A-x>    — Alt+x
#   <S-TAB>  — Shift+Tab
#   <CR>     — Enter
#   <ESC>    — Escape
#   <Space>  — Spacebar

# ─── Basic Operations ───────────────────────────────────────────────────────

map     Q quitall
map     q quit
copymap q ZZ ZQ

map R     reload_cwd
map F     set freeze_files!
map <C-r> reset
map <C-l> redraw_window
map <C-c> abort
map <esc> change_mode normal

# Toggle between miller columns and multipane view
map ~ set viewmode!

# View file details / scroll preview
map i display_file
map <A-j> scroll_preview 1
map <A-k> scroll_preview -1

# Help and logs
map ? help
map W display_log
map w taskview_open

# Open a shell in the current directory
map S shell $SHELL

# Console access
map :  console
map ;  console
map !  console shell%space
map @  console -p6 shell  %%s
map #  console shell -p%space
map s  console shell%space
map r  chain draw_possible_programs; console open_with%space
map f  console find%space
map cd console cd%space

map <C-p> chain console; eval fm.ui.console.history_move(-1)

# ─── Line Modes (how files are displayed) ────────────────────────────────────
#   Mf — filename only
#   Mi — with file info
#   Mm — with modification time
#   Mp — with permissions
#   Ms — with size + mtime

map Mf linemode filename
map Mi linemode fileinfo
map Mm linemode mtime
map Mh linemode humanreadablemtime
map Mp linemode permissions
map Ms linemode sizemtime
map MH linemode sizehumanreadablemtime
map Mt linemode metatitle

# ─── Tagging & Marking ──────────────────────────────────────────────────────
#   Space  — toggle mark on current file (easy one-hand operation)
#   v      — mark/unmark all files
#   V      — visual selection mode (like vim)
#   t      — tag file (persistent across sessions)

map t       tag_toggle
map ut      tag_remove
map "<any>  tag_toggle tag=%any
map <Space> mark_files toggle=True
map v       mark_files all=True toggle=True
map uv      mark_files all=True val=False
map V       toggle_visual_mode
map uV      toggle_visual_mode reverse=True

# ─── Midnight Commander F-Key Bindings ───────────────────────────────────────
#   For users coming from MC — familiar shortcuts on function keys

map <F1> help
map <F2> rename_append
map <F3> display_file
map <F4> edit
map <F5> copy
map <F6> cut
map <F7> console mkdir%space
map <F8> console trash
map <F10> exit

# ─── Movement ───────────────────────────────────────────────────────────────
#   Arrow keys and vim-style h/j/k/l both work.
#   J/K — page half-down/up (fast scrolling)

map <UP>       move up=1
map <DOWN>     move down=1
map <LEFT>     move left=1
map <RIGHT>    move right=1
map <HOME>     move to=0
map <END>      move to=-1
map <PAGEDOWN> move down=1   pages=True
map <PAGEUP>   move up=1     pages=True
map <CR>       move right=1
map <INSERT>   console touch%space

# Vim-like movement
copymap <UP>       k
copymap <DOWN>     j
copymap <LEFT>     h
copymap <RIGHT>    l
copymap <HOME>     gg
copymap <END>      G
copymap <PAGEDOWN> <C-F>
copymap <PAGEUP>   <C-B>

# Half-page scrolling
map J  move down=0.5  pages=True
map K  move up=0.5    pages=True
copymap J <C-D>
copymap K <C-U>

# ─── History & Parent Navigation ────────────────────────────────────────────
#   H/L — go back/forward in history (like a browser)
#   [/] — move to previous/next parent directory
#   }   — traverse into highlighted directory

map H     history_go -1
map L     history_go 1
map ]     move_parent 1
map [     move_parent -1
map }     traverse
map {     traverse_backwards
map )     jump_non

# ─── Quick Navigation (go-to shortcuts) ─────────────────────────────────────
#   These mirror the Thunar sidebar bookmarks from bookmarks.tmpl
#   so you navigate the same way in both file managers.
#
#   g + key:
#     gh — Home (~)
#     gp — Projects
#     gd — Downloads
#     gD — Documents
#     gP — Pictures
#     gm — Music
#     gv — Videos
#     gc — ~/.config
#     gl — ~/.local/share
#     gr — Rices directory
#     gw — Wallpapers
#     gb — ~/.local/bin (scripts)
#     gT — /tmp

map gh cd ~
map gp cd ~/Projects
map gd cd ~/Downloads
map gD cd ~/Documents
map gP cd ~/Pictures
map gm cd ~/Music
map gv cd ~/Videos
map gc cd ~/.config
map gl cd ~/.local/share
map gr cd ~/.local/share/dots/rices
map gw cd ~/.local/share/wallpapers
map gb cd ~/.local/bin
map gT cd /tmp
map ge cd /etc
map gu cd /usr
map g/ cd /
map gM cd /mnt
map gi eval fm.cd('/run/media/' + os.getenv('USER'))
map gR eval fm.cd(ranger.RANGERDIR)
map g? cd /usr/share/doc/ranger

# ─── File Editing & Opening ─────────────────────────────────────────────────

map E  edit
map du shell -p du --max-depth=1 -h --apparent-size
map dU shell -p du --max-depth=1 -h --apparent-size | sort -rh

# ─── Yank (Copy to Clipboard) ───────────────────────────────────────────────
#   yp — copy full path to Wayland clipboard
#   yd — copy directory path
#   yn — copy filename
#   y. — copy filename without extension
#
#   Uses wl-copy for Wayland (with xclip fallback for X11)

map yp eval fm.execute_console("shell -f bash -c 'echo -n %d/%f | wl-copy 2>/dev/null || echo -n %d/%f | xclip -selection clipboard'")
map yd eval fm.execute_console("shell -f bash -c 'echo -n %d | wl-copy 2>/dev/null || echo -n %d | xclip -selection clipboard'")
map yn eval fm.execute_console("shell -f bash -c 'echo -n %f | wl-copy 2>/dev/null || echo -n %f | xclip -selection clipboard'")
map y. yank name_without_extension

# ─── Filesystem Operations ──────────────────────────────────────────────────

map =  chmod

# Rename (multiple approaches for flexibility)
map cw console rename%space
map a  rename_append
map A  eval fm.open_console('rename ' + fm.thisfile.relative_path.replace("%", "%%"))
map I  eval fm.open_console('rename ' + fm.thisfile.relative_path.replace("%", "%%"), position=7)

# Paste operations
map pp paste
map po paste overwrite=True
map pP paste append=True
map pO paste overwrite=True append=True
map pl paste_symlink relative=False
map pL paste_symlink relative=True
map phl paste_hardlink
map pht paste_hardlinked_subtree
map pd console paste dest=
map p`<any> paste dest=%any_path
map p'<any> paste dest=%any_path

# ─── Safe Delete (Trash) vs Permanent Delete ────────────────────────────────
#   DD — move to trash (SAFE — use this by default!)
#   dD — permanent delete (asks for confirmation)
#   dT — also moves to trash
#
#   To empty trash:  :shell trash-empty
#   To list trash:   :shell trash-list

map DD shell -s trash-put %s
map dD console delete
map dT console trash

# Cut/Copy operations (vim-style)
map dd cut
map ud uncut
map da cut mode=add
map dr cut mode=remove
map dt cut mode=toggle

map yy copy
map uy uncut
map ya copy mode=add
map yr copy mode=remove
map yt copy mode=toggle

# Temporary workarounds for range operations
map dgg eval fm.cut(dirarg=dict(to=0), narg=quantifier)
map dG  eval fm.cut(dirarg=dict(to=-1), narg=quantifier)
map dj  eval fm.cut(dirarg=dict(down=1), narg=quantifier)
map dk  eval fm.cut(dirarg=dict(up=1), narg=quantifier)
map ygg eval fm.copy(dirarg=dict(to=0), narg=quantifier)
map yG  eval fm.copy(dirarg=dict(to=-1), narg=quantifier)
map yj  eval fm.copy(dirarg=dict(down=1), narg=quantifier)
map yk  eval fm.copy(dirarg=dict(up=1), narg=quantifier)

# ─── Custom Power Commands ──────────────────────────────────────────────────
#   These are defined in commands.py — see that file for documentation.
#
#   Ctrl-f — Fuzzy find files with fzf (live preview!)
#   Ctrl-g — Search inside file contents with ripgrep
#   C      — Compress selected files (choose format)
#   X      — Extract archive (smart format detection)
#   mkcd   — Create directory and enter it
#   :open_in_thunar — Open current dir in Thunar GUI
#   :cheatsheet     — Show this keybinding reference

map <C-f> fzf_select
map <C-g> fzf_rga
map C compress
map X extract
map <A-t> shell kitty --class thunar -e thunar %d &

# Bulk rename — open filenames in $EDITOR for powerful batch renaming
map cw eval fm.execute_console("bulkrename") if fm.thisdir.marked_items else fm.open_console("rename ")

# ─── Searching ──────────────────────────────────────────────────────────────

map /  console search%space
map n  search_next
map N  search_next forward=False
map ct search_next order=tag
map cs search_next order=size
map ci search_next order=mimetype
map cc search_next order=ctime
map cm search_next order=mtime
map ca search_next order=atime

# ─── Tabs ────────────────────────────────────────────────────────────────────
#   Ctrl-n     — new tab
#   Ctrl-w     — close tab
#   Tab/S-Tab  — switch tabs
#   Alt-1..9   — jump to tab by number

map <C-n>     tab_new
map <C-w>     tab_close
map <TAB>     tab_move 1
map <S-TAB>   tab_move -1
map <A-Right> tab_move 1
map <A-Left>  tab_move -1
map gt        tab_move 1
map gT        tab_move -1
map gn        tab_new
map gc        tab_close
map uq        tab_restore
map <a-1>     tab_open 1
map <a-2>     tab_open 2
map <a-3>     tab_open 3
map <a-4>     tab_open 4
map <a-5>     tab_open 5
map <a-6>     tab_open 6
map <a-7>     tab_open 7
map <a-8>     tab_open 8
map <a-9>     tab_open 9
map <a-r>     tab_shift 1
map <a-l>     tab_shift -1

# ─── Sorting ────────────────────────────────────────────────────────────────
#   Press 'o' then a letter to change sort order:
#     os — by size          oS — by size (reverse)
#     on — by name          oN — by name (reverse)
#     om — by modified time oM — by mtime (reverse)
#     ot — by type          oT — by type (reverse)
#     oe — by extension     oE — by extension (reverse)
#     or — toggle reverse

map or set sort_reverse!
map oz set sort=random
map os chain set sort=size;      set sort_reverse=False
map ob chain set sort=basename;  set sort_reverse=False
map on chain set sort=natural;   set sort_reverse=False
map om chain set sort=mtime;     set sort_reverse=False
map oc chain set sort=ctime;     set sort_reverse=False
map oa chain set sort=atime;     set sort_reverse=False
map ot chain set sort=type;      set sort_reverse=False
map oe chain set sort=extension; set sort_reverse=False

map oS chain set sort=size;      set sort_reverse=True
map oB chain set sort=basename;  set sort_reverse=True
map oN chain set sort=natural;   set sort_reverse=True
map oM chain set sort=mtime;     set sort_reverse=True
map oC chain set sort=ctime;     set sort_reverse=True
map oA chain set sort=atime;     set sort_reverse=True
map oT chain set sort=type;      set sort_reverse=True
map oE chain set sort=extension; set sort_reverse=True

map dc get_cumulative_size

# ─── Settings Toggles ───────────────────────────────────────────────────────
#   Press 'z' then a letter to toggle settings:
#     zh — toggle hidden files
#     zp — toggle file previews
#     zi — toggle image previews
#     zm — toggle mouse

map zc    set collapse_preview!
map zd    set sort_directories_first!
map zh    set show_hidden!
map <C-h> set show_hidden!
copymap <C-h> <backspace>
copymap <backspace> <backspace2>
map zI    set flushinput!
map zi    set preview_images!
map zm    set mouse_enabled!
map zp    set preview_files!
map zP    set preview_directories!
map zs    set sort_case_insensitive!
map zu    set autoupdate_cumulative_size!
map zv    set use_preview_script!
map zf    console filter%space
copymap zf zz

# ─── Filter Stack ───────────────────────────────────────────────────────────
#   Powerful file filtering system:
#     .d — show only directories
#     .f — show only files
#     .l — show only symlinks
#     .n — filter by name pattern
#     .c — clear all filters

map .d filter_stack add type d
map .f filter_stack add type f
map .l filter_stack add type l
map .m console filter_stack add mime%space
map .n console filter_stack add name%space
map .# console filter_stack add hash%space
map ." filter_stack add duplicate
map .' filter_stack add unique
map .| filter_stack add or
map .& filter_stack add and
map .! filter_stack add not
map .r filter_stack rotate
map .c filter_stack clear
map .* filter_stack decompose
map .p filter_stack pop
map .. filter_stack show

# ─── Bookmarks ──────────────────────────────────────────────────────────────
#   m<key>  — set bookmark
#   `<key>  — go to bookmark
#   um<key> — unset bookmark

map `<any>  enter_bookmark %any
map '<any>  enter_bookmark %any
map m<any>  set_bookmark %any
map um<any> unset_bookmark %any

map m<bg>   draw_bookmarks
copymap m<bg>  um<bg> `<bg> '<bg>

# ─── Chmod Mappings ─────────────────────────────────────────────────────────
#   +ur — add user read    -ur — remove user read
#   +gw — add group write  -ow — remove other write
#   etc.

eval for arg in "rwxXst": cmd("map +u{0} shell -f chmod u+{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map +g{0} shell -f chmod g+{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map +o{0} shell -f chmod o+{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map +a{0} shell -f chmod a+{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map +{0}  shell -f chmod u+{0} %s".format(arg))

eval for arg in "rwxXst": cmd("map -u{0} shell -f chmod u-{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map -g{0} shell -f chmod g-{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map -o{0} shell -f chmod o-{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map -a{0} shell -f chmod a-{0} %s".format(arg))
eval for arg in "rwxXst": cmd("map -{0}  shell -f chmod u-{0} %s".format(arg))

# ═══════════════════════════════════════════════════════════════════════════════
# ══ CONSOLE KEYBINDINGS
# ═══════════════════════════════════════════════════════════════════════════════

cmap <tab>   eval fm.ui.console.tab()
cmap <s-tab> eval fm.ui.console.tab(-1)
cmap <ESC>   eval fm.ui.console.close()
cmap <CR>    eval fm.ui.console.execute()
cmap <C-l>   redraw_window

copycmap <ESC> <C-c>
copycmap <CR>  <C-j>

# Movement in console
cmap <up>    eval fm.ui.console.history_move(-1)
cmap <down>  eval fm.ui.console.history_move(1)
cmap <left>  eval fm.ui.console.move(left=1)
cmap <right> eval fm.ui.console.move(right=1)
cmap <home>  eval fm.ui.console.move(right=0, absolute=True)
cmap <end>   eval fm.ui.console.move(right=-1, absolute=True)
cmap <a-b>   eval fm.ui.console.move_word(left=1)
cmap <a-f>   eval fm.ui.console.move_word(right=1)

copycmap <a-b> <a-left>
copycmap <a-f> <a-right>

# Editing in console
cmap <backspace>  eval fm.ui.console.delete(-1)
cmap <delete>     eval fm.ui.console.delete(0)
cmap <C-w>        eval fm.ui.console.delete_word()
cmap <A-d>        eval fm.ui.console.delete_word(backward=False)
cmap <C-k>        eval fm.ui.console.delete_rest(1)
cmap <C-u>        eval fm.ui.console.delete_rest(-1)
cmap <C-y>        eval fm.ui.console.paste()

# Emacs-style shortcuts in console
copycmap <ESC>       <C-g>
copycmap <up>        <C-p>
copycmap <down>      <C-n>
copycmap <left>      <C-b>
copycmap <right>     <C-f>
copycmap <home>      <C-a>
copycmap <end>       <C-e>
copycmap <delete>    <C-d>
copycmap <backspace> <C-h>

copycmap <backspace> <backspace2>

cmap <allow_quantifiers> false

# ═══════════════════════════════════════════════════════════════════════════════
# ══ PAGER KEYBINDINGS
# ═══════════════════════════════════════════════════════════════════════════════

pmap  <down>      pager_move  down=1
pmap  <up>        pager_move  up=1
pmap  <left>      pager_move  left=4
pmap  <right>     pager_move  right=4
pmap  <home>      pager_move  to=0
pmap  <end>       pager_move  to=-1
pmap  <pagedown>  pager_move  down=1.0  pages=True
pmap  <pageup>    pager_move  up=1.0    pages=True
pmap  <C-d>       pager_move  down=0.5  pages=True
pmap  <C-u>       pager_move  up=0.5    pages=True

copypmap <UP>       k  <C-p>
copypmap <DOWN>     j  <C-n> <CR>
copypmap <LEFT>     h
copypmap <RIGHT>    l
copypmap <HOME>     g
copypmap <END>      G
copypmap <C-d>      d
copypmap <C-u>      u
copypmap <PAGEDOWN> n  f  <C-F>  <Space>
copypmap <PAGEUP>   p  b  <C-B>

pmap     <C-l> redraw_window
pmap     <ESC> pager_close
copypmap <ESC> q Q i <F3>
pmap E      edit_file

# ═══════════════════════════════════════════════════════════════════════════════
# ══ TASKVIEW KEYBINDINGS
# ═══════════════════════════════════════════════════════════════════════════════

tmap <up>        taskview_move up=1
tmap <down>      taskview_move down=1
tmap <home>      taskview_move to=0
tmap <end>       taskview_move to=-1
tmap <pagedown>  taskview_move down=1.0  pages=True
tmap <pageup>    taskview_move up=1.0    pages=True
tmap <C-d>       taskview_move down=0.5  pages=True
tmap <C-u>       taskview_move up=0.5    pages=True

copytmap <UP>       k  <C-p>
copytmap <DOWN>     j  <C-n> <CR>
copytmap <HOME>     g
copytmap <END>      G
copytmap <C-u>      u
copytmap <PAGEDOWN> n  f  <C-F>  <Space>
copytmap <PAGEUP>   p  b  <C-B>

tmap J          eval -q fm.ui.taskview.task_move(-1)
tmap K          eval -q fm.ui.taskview.task_move(0)
tmap dd         eval -q fm.ui.taskview.task_remove()
tmap <pagedown> eval -q fm.ui.taskview.task_move(-1)
tmap <pageup>   eval -q fm.ui.taskview.task_move(0)
tmap <delete>   eval -q fm.ui.taskview.task_remove()

tmap <C-l> redraw_window
tmap <ESC> taskview_close
copytmap <ESC> q Q w <C-c>
