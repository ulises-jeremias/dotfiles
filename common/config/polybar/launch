#!/usr/bin/env sh

has_param() {
    local term="$1"
    shift
    for arg; do
        if [[ $arg == "$term" ]]; then
            return 0
        fi
    done
    return 1
}

# Terminate already running bar instances
killall -q polybar
export POLYBAR_SESSION=""

# Wait until the processes have been shut down
while pgrep -u $UID -x polybar > /dev/null; do sleep 1; done

if has_param "--top-bar-only" "$@"; then
    polybar polybar-top-only -r
elif has_param "--small-top-bar-only" "$@"; then
    polybar small-polybar-top-only -r
elif has_param "--two-bars-small-layout" "$@"; then
    polybar small-polybar-top -r &
    polybar small-polybar-bottom -r
else
    polybar polybar-top -r &
    polybar polybar-bottom -r
fi
